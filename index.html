<html>
<head>
  <title>EVS app</title>
<style>
body{
background-repeat:no-repeat;
background-size: contain;
}
canvas{
background-image: url("background.jpg.svg");
background-repeat: no-repeat;
background-size:contain;
}
.svg{
background-repeat: no-repeat;
background-size: contain;
  background-image:url("background.jpg.svg");
}

</style>
<!-- Compiled and minified CSS -->
  <!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">
  <script type="text/javascript" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>-->

  <!-- Compiled and minified JavaScript -->
  <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>-->
</head>
<body>
  <div>
   <div>
     <label class="active" for="first_name2">Input</label>
     <input id="first_name2" type="text">
     <label class="active" for="first_name3">Number of loops</label>
     <input id="first_name3" type="text">

     <button onclick="frame()">Simulate</button>

   </div>
 </div>

<svg class = "svg" width="1000" height="900">
  <path d="M0 0 L-245 235" id="wire"/>
  <path d="M-260 290 L380 270" id="wire1"/>
  <path d="M-260 290 L150 195" id="wire2"/>
  <path d="M430 258 L60 15" id="wire3"/>
  <circle cx="450" cy="205" r="10" stroke="black" id="point" stroke-width="3" fill="red" >

    <animateMotion begin="indefinite" id="test1" dur="5s" repeatCount="1">
      <mpath id="mpath" xlink:href="#wire"></mpath>
    </animateMotion>
  </circle>
  <circle cx="450" cy="205" r="10" stroke="black" stroke-width="3" fill="red" >

    <animateMotion id="test2" begin="test1.end" onbegin="setText(1,'phosphorus in soil')" dur="5s" repeatCount="1">
      <mpath id="mpath1" xlink:href="#wire1"></mpath>
    </animateMotion>
  </circle>
  <circle cx="450" cy="205" r="10" stroke="black" stroke-width="3" fill="red" >

    <animateMotion id="test3" begin="test1.end" dur="5s" repeatCount="1">
      <mpath id="mpath2" xlink:href="#wire2"></mpath>
    </animateMotion>
  </circle>
  <circle cx="450" cy="205" r="10" stroke="black" stroke-width="3" fill="red" >

    <animateMotion id="test4" begin="test3.end" dur="5s" onbegin="setText(3,'phosphorus in ocean'); setText(2,'phosphorus in plants')" onend="frame()" repeatCount="1">
      <mpath id="mpath3" xlink:href="#wire3"></mpath>
    </animateMotion>
  </circle>
    <line x1="450" y1="205" x2="210" y2="435" style="stroke:rgb(255,0,0);stroke-width:2" marker-end="url(#arrowhead)"/>
    <line x1="190" y1="495" x2="580" y2="405" style="stroke:rgb(255,0,0);stroke-width:2" marker-end="url(#arrowhead)"/>
    <line x1="190" y1="495" x2="830" y2="475" style="stroke:rgb(255,0,0);stroke-width:2" marker-end="url(#arrowhead)"/>
    <line x1="900" y1="475" x2="520" y2="225" style="stroke:rgb(255,0,0);stroke-width:2" marker-end="url(#arrowhead)"/>
  <rect x="400" y="180" width="100" height="50" style="fill:rgb(0,0,255);stroke-width:3;stroke:rgb(0,0,0)" />
  <rect x="150" y="450" width="80" height="50" style="fill:rgb(0,0,255);stroke-width:3;stroke:rgb(0,0,0)" />
  <rect x="850" y="450" width="100" height="50" style="fill:rgb(0,0,255);stroke-width:3;stroke:rgb(0,0,0)" />
  <rect x="600" y="380" width="70" height="50" style="fill:rgb(0,0,255);stroke-width:3;stroke:rgb(0,0,0)" />
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7"
    refX="0" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" />
    </marker>
  </defs>
<text x="410" y="205" fill="black" font-size="15">

</text>
<text x="155" y="480" fill="black" font-size="15">

</text>
<text x="855" y="480" fill="black" font-size="15">

</text>
<text x="605" y="410" fill="black" font-size="15">

</text>
</svg>

<script type="text/javascript" language="javascript">

var i=0;
document.getElementById('first_name3').onchange = function(){
  i=0;
}
function frame(){
  /*var animate = document.getElementById('mpath')
  animate.setAttributeNS("http://www.w3.org/1999/xlink","href","#wire");
  var animate = document.getElementById('mpath1')
  animate.setAttributeNS("http://www.w3.org/1999/xlink","href","#wire1");
  var animate = document.getElementById('mpath2')
  animate.setAttributeNS("http://www.w3.org/1999/xlink","href","#wire2");
  var animate = document.getElementById('mpath3')
  animate.setAttributeNS("http://www.w3.org/1999/xlink","href","#wire3");
  */
  var no = document.getElementById('first_name3').value;
  console.log({no:parseInt(no),i:i})
if(i!=parseInt(no)){
  beginAnimation();
}
}
function setText(i,text){
var texts = document.getElementsByTagName('text')
texts[i].innerHTML = text;
}
function beginAnimation(){
  var animate = document.getElementById("test1")
    var texts = document.getElementsByTagName('text');
    for(j=0;j<texts.length;j++){
        texts[j].innerHTML = ""
    }
  setText(0,"phosphorus in mountain");
  animate.beginElement();
    i++;
}
</script>
</body>
</html>
